"use strict";(self.webpackChunkpathvector_docs=self.webpackChunkpathvector_docs||[]).push([[0],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return d}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),l=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),h=l(r),d=o,m=h["".concat(s,".").concat(d)]||h[d]||u[d]||a;return r?n.createElement(m,i(i({ref:t},c),{},{components:r})):n.createElement(m,i({ref:t},c))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=h;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var l=2;l<a;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},1475:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return p},metadata:function(){return s},toc:function(){return l},default:function(){return u}});var n=r(7462),o=r(3366),a=(r(7294),r(3905)),i=["components"],p={},s={unversionedId:"portal",id:"portal",isDocsHomePage:!1,title:"Peering Portal",description:"Docs",source:"@site/docs/portal.md",sourceDirName:".",slug:"/portal",permalink:"/docs/portal",editUrl:"https://github.com/natesales/pathvector/edit/main/docs/docs/portal.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"DDoS mitigation with FastNetMon",permalink:"/docs/integrations/fastnetmon"}},l=[{value:"Setup",id:"setup",children:[{value:"PeeringDB OAuth",id:"peeringdb-oauth",children:[]},{value:"Peering Portal",id:"peering-portal",children:[]},{value:"Routers",id:"routers",children:[]}]},{value:"Usage",id:"usage",children:[]},{value:"CLI",id:"cli",children:[]}],c={toc:l};function u(e){var t=e.components,r=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://pathvector.io"},(0,a.kt)("img",{parentName:"a",src:"https://img.shields.io/static/v1?label=ABOUT&message=pathvector.io&color=9407cd&style=for-the-badge",alt:"Docs"})),"\n",(0,a.kt)("a",{parentName:"p",href:"https://goreportcard.com/report/github.com/natesales/pathvector-portal"},(0,a.kt)("img",{parentName:"a",src:"https://goreportcard.com/badge/github.com/natesales/pathvector-portal?style=for-the-badge",alt:"Go Report"})),"\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/natesales/pathvector-portal/blob/main/LICENSE"},(0,a.kt)("img",{parentName:"a",src:"https://img.shields.io/github/license/natesales/pathvector-portal?style=for-the-badge",alt:"License"}))),(0,a.kt)("p",null,"The Pathvector Peering Portal is a web interface for multi-router peering session management. Peers can log in with PeeringDB OAuth to see the status of their current sessions and configure new sessions at common internet exchanges."),(0,a.kt)("p",null,"This project is part of Pathvector and works best on Pathvector routers. The API is generic enough though, that it's possible to integrate other vendors the portal."),(0,a.kt)("h2",{id:"setup"},"Setup"),(0,a.kt)("h3",{id:"peeringdb-oauth"},"PeeringDB OAuth"),(0,a.kt)("p",null,"Create a new PeeringDB OAuth application at ",(0,a.kt)("a",{parentName:"p",href:"https://peeringdb.com/oauth2/applications/"},"https://peeringdb.com/oauth2/applications/")," with client type ",(0,a.kt)("inlineCode",{parentName:"p"},"Confidential")," and authorization grant type ",(0,a.kt)("inlineCode",{parentName:"p"},"Authorization code"),". The redirect URI is in the format of ",(0,a.kt)("inlineCode",{parentName:"p"},"https://peering.example.com/auth/redirect")),(0,a.kt)("h3",{id:"peering-portal"},"Peering Portal"),(0,a.kt)("p",null,"The easiest way to deploy the peering portal is with docker-compose. An example compose file is available ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/natesales/pathvector-portal/blob/main/docker-compose.yml"},"here"),". You will also need a reverse proxy in front of the portal container to forward requests from the internet to http://peering-portal:8080 on the container."),(0,a.kt)("h3",{id:"routers"},"Routers"),(0,a.kt)("p",null,"Once you have the portal running, just add the ",(0,a.kt)("inlineCode",{parentName:"p"},"portal-host"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"portal-key"),", and optionally ",(0,a.kt)("inlineCode",{parentName:"p"},"hostname")," fields to your Pathvector config on each router that you want to use. Pathvector will then push BGP session status to the portal server on each run."),(0,a.kt)("h2",{id:"usage"},"Usage"),(0,a.kt)("p",null,"The portal server exposes the web interface and API on :8080 by default."),(0,a.kt)("h2",{id:"cli"},"CLI"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl")," utility provides a quick way to query and manage sessions from the command line. ",(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl")," is available from ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/natesales/pathvector-portal/releases"},"GitHub Releases")," and the ",(0,a.kt)("a",{parentName:"p",href:"https://pathvector.io/docs/installation#package-repository"},"Pathvector apt repository"),"."),(0,a.kt)("h4",{id:"usage-1"},"Usage"),(0,a.kt)("p",null,"Get all sessions:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl sessions")),(0,a.kt)("p",null,"Get all sessions for an ASN, router, or both, optionally filtering by sessions that aren't established:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl sessions [--down] 34553")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl sessions [--down] edge1.pdx1")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl sessions [--down] --asn 34553 --router edge1.pdx1")),(0,a.kt)("p",null,"Remove all sessions for a router:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"peeringctl clear edge1.pdx1")))}u.isMDXComponent=!0}}]);